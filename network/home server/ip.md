

IP : 
LAN, WAN, 인터넷에서 사용되는 전화번호라고 생각하자. 전화번호를 외우기 힘드니 이름을 등록하는 전화번호부같은 역할을 DNS가 한다.

평소 자주 사용되는 IP주소는 IPv4이다. 근데 이 주소가 부족해지면서 IPv6 주소가 늘어나는 추세다. 

4바이트(32bit)로 이루어진 주소 번호를 사용하여 각각의 노드를 구분하여 목적지를 찾아가게 된다. 이를 IP Adress라고 한다. "192.168.100.100"과 같은 형태다. 

## IPv4

Internet Protocol의 4번째 판이다. 과거에는 유일한 프로톸로이었으나 요새는 IPv6이 대중화되었다. IPv4는 패킷 교환 네트워크 상에서 

숫자로된 주소를 사람이 식별하기 쉽게 Domain네임으로 변환해주는 Domain Name 서비스를 이용한다. 

패킷 교환 네트워크 상에서 데이터를 교환하기 위한 프로토콜이다. 데이터가 정확하게 전달 될 것을 보장하지 않고, 중복된 패킷 or 패킷의 순서가 바뀔 수 있다. 데이터의 정확성, 순차성은 상위 프로토콜인 TCP에서 보장한다.

IPv4의 주소쳬게는 총 12자리이고 네 부분으로 나뉜다. 0~255까지 3자리 수로 표현된다. IPv4 주소는 32비트이다. 


### IP 할당

고정된 IP 주소를 할당받아 사용하는 방법 이외에 DHCP를 이용하여 동적으로 IP 주소를 할당받는 방법도 있다. 

> DHCP(Dynamic Host Configuration Protocol)
공인 IP, 사설 IP
공인 IP는 인터넷에서 사용되는 IP, 사설IP는 인터넷에서 사용 불가 .공유기 내부의 네트워크에서만 사용 가능한 주소.

내 커멑가 인터넷 공유기 사용자히 않고 ISP(kt, lg)가 제공한 모뎀과 직결로 연결되어있다면, **공인 IP** 사용중. 이 경우 다른 곳에서 인터넷을 사용하고 있는 다른 사람의 컴에서 내 컴퓨터에 사용하고 있는 공인 IP를 알고 있다면, 그 아이피 주소로 내 컴터를 찾아 접속 가능.

ISP가 제공하는 모뎀에 직결로 연결되지 않고, 공유기를 통해 연결되어있다면 내 컴터는 **사설 IP**를 사용중. 


#### 공인 IP

IPv4는 임의로 우리가 부여하는 것이 아니다. ICANN이라는 기관이 국가별로 사용할 IP 대역을 관리한다. 우리나라는 KISA가 관린하다. 따라서, 아무 IP 주소나 내 컴터에 지정한다고 인터넷이 되는게 아닌 할당받은 주소를 부여해야만 인터넷에 접속 가능하다.

IPv4는 4자리의 대역에 따라 클래스 별로 분류한다. 그거슨 A,B,C 클래스다.

이와 같이 클래스로 분류했지만 IP가 부족해서 서버 운영시 원하는대로 IP 주소를 부여받을 수 없다. **서버 운영 업체나 기관들에게 할당된 주소 중 자신의 컴퓨터에 주소를 할당 받아야 한다.**

> 최근의 IP 부족 사태는 인터넷 발전 초기에 IP 주소를 무계획적으로 배분했기 때문에 발생하는 문제이다. 대표적으로 미국의 일반 기업인 IBM이나 모토롤라 등은 초기에 인터넷 주소를 부여받으면서 A 클래스를 부여받았고, 우리나라내에서도 KAIST나 서울대 등은 B 클래스를 보유하여 학교내의 PC들에게도 마구 공인 IP를 부여하고 있는 웃지 못할 상황이다. 반면 최근에 IP를 신청하는 기업은 많은 비용을 지불하고도 C 클래스 대역조차 얻기가 쉽지않은 현실이다.

#### 사설 IP

특수 목적으로 사용하기 위해 몇개 대역을 제외하고 공인 IP 대역으로 할당하고 있다. 제외된 대역 중 사설 IP로 사용되는 대역은 사용자가 임의로 부여하고 사용할 수 있다. 하지만 인터넷 상에서 서로 연결되지 않는다. 전체 IP 대역 중 다음 대역이 사설 IP 대역이다.

A 클래스 : 10.0.0.0 ~ 10.255.255.255
B 클래스 : 172.16.0.0 ~ 172.31.255.255
C 클래스 : 192.168.0.0 ~ 192.168.255.255

위의 3개 클래스 대역은 사용자가 자신의 컴퓨터에 임의로 부여해도 되는 IP 주소 대역이다. 따라서 회사나 집에서 공인 IP 부여받지 않은 상태에서 위의 주소 대역 중 아무 주소나 할당을 해도 문제 없다.

따라서 공인 IP 주소가 모자랄 경우 사설 IP로 회사나 가정 내의 IP 주소를 부여하고 공유기 등에 고정 IP를 부여한 다음에 인터넷에 접속하는 방식이 널리 퍼지게 되었고, 대부분의 장비가 현재는 사설 IP를 부여하고 공유기나 라우터(사실 공유기가 라우터다)를 통해 인터넷에 접속하게 된다. 단 사설 IP를 부여한 컴퓨터는 공인 IP에서 알아볼 수가 없다는 점이 특징이다.

[!img](http://gotocloud.co.kr/wp-content/uploads/2013/03/IP2.png)
위의 그림을 보면 컴퓨터에 부여된 IP 주소인 192.168.0.2 ~ 192.168.0.4과 공유기의 내부 주소인 192.168.0.1은 사설 IP이고 공유기가 인터넷에 연결된 168.126.63.1은 공인 IP가 된다. 서버에 설치된 IP인 164.124.101.2도 공인 IP이다. 따라서 인터넷 상에서  164.124.101.2라는 주소를 치면 서버에 접속할 수 있지만 192.168.0.x 대역에 있는 피시와 노트북에는 접속할 수 없다. 가정에 설치된 공유기 관리 화면에 접속해보면 위의 같은 형태로 IP가 부여되어 있음을 알 수 있을 것이다.

또한 공유기에는 위아래로 두가지 IP가 기재되어있다. 인터넷과 연결된 WAN포트에는 공인 IP, 내부 컴터 들과 연결되어 있는 LAN 포트에는 사설IP가 있다. 이 공유기와 연결된 모든 컴터는 인터넷에 접속하기 위해 반드시 공유기 LAN쪽 IP를 지나야 한다. 그래서 네트워크 용어로 **GateWay**라고 한다.

#### 고정 IP와 유동 IP

고정 IP는 컴퓨터에 고정적으로 부여된 IP로 한번 부여되면 IP를 반납하기 전까지는 다른 장비에 부여할 수 없는 IP 주소를 말한다. 유동 IP는 장비에 고정적으로 IP를 부여하지 않고 컴퓨터를 사용할 때 남아 있는 IP 중에서 돌아가면서 부여하는 IP를 뜻한다. 부여받은 IP가 10개이고 접속해야할 컴퓨터가 20대라면 10대는 고정 IP를 부여할 경우 IP가 모자라므로 유동 IP로 10개를 20대가 돌아가면서 사용할 수 있다.

이상으로 간략하게 공인 IP와 사설 IP, 고정 IP와 유동 IP에 대해서 살펴봤는데, 결론적으로 인터넷 상에서 서버를 운영하고자 할 때는 공인 IP를 고정 IP로 부여해야 한다는 것이 중요하다. 즉, 공인 IP를 부여받지 못하면 다른 사람이 내 서버에 접속할 수가 없고, 고정 IP를 부여하지 않으면 내 서버가 아닌 다른 사람의 서버로 접속이 될 수도 있기 때문이다.

반면에 우리가 집에서 사용하는 인터넷 서비스 업체는 각 가정마다 공인 IP를 유동 IP로 부여하고, 공유기 내부에서는 사설 IP를 유동 IP로 부여하는 것이 일반적이라고 보면 될 것이다.



> qna
혹시 내부IP주소를 사설IP범위가 아닌 35.35.x.x 이런식으로 부여하면 생기는 문제점은 무엇인가요? 공인IP와 충돌이 생기는 건가요?
물론 사용은 가능하나,
해당대역의 공인IP를 사용하는 서버는 접속이 되지 않습니다.

예를들어
35.35.x.x 를 네이버가 사용중이라면
내부IP를 사용하는 곳에서는 네이버 접속이 불가능합니다.

## 서브넷 마스크

*브로드캐스트의 단점?*을 보완하기 위한 방법이다. 할당된 IP주소를 네트워크 환경에 맞게 나누어 주는 방식이다.

IP주소의 어디까지가 네트워크이고, 호스트인지 보여주는 역할도 한다. 네트워크는 서브넷마스크를 이진수로 표기했을 경우 1로 보여주는 부분, 호스트는 0으로 표시되는 부분이다. 

클래스C를 예로 들면 디폴트 서브넷 마스크를 2진수로 표기한 부분에서 앞 세자리가 네트워크 뒤 한자리가 호스트인 것을 알 수 있다. 

클래스C: 255.255.255.0 => 11111111.11111111.11111111.000000000

요약하면 한개의 IP주소에 서브넷마스크를 이용하여 네트워크를 나누는 방법이다. 브로드 캐스트 영역을 나누고 IP주소를 아껴서 다양하게 사용할 수 있고, 서브넷 없이 걍 사용시 브로드캐스트 도메인이 너무 커지는 문제 발생한다.